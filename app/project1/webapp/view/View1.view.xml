<mvc:View
    controllerName="com.sap.dashboard.controller.Dashboard"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:layout="sap.ui.layout"
    displayBlock="true">

    <Page
        id="dashboardPage"
        title="SAP Report Dashboard"
        showNavButton="false"
        class="sapUiResponsiveContentPadding">

        <content>
            <ScrollContainer height="100%" width="100%" vertical="true" horizontal="false">

                <layout:Grid
                    defaultSpan="L4 M6 S12"
                    hSpacing="1"
                    vSpacing="1"
                    containerQuery="true">

                    <!-- Vendor Master Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Vendor Master"
                        press="onVendorPress">
                        <TileContent 
                            footer="{dashboardModel>/newVendorsThisWeek} new this week">
                            <NumericContent
                                value="{dashboardModel>/vendorCount}"
                                icon="sap-icon://supplier"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                    <!-- Master Materials Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Master Materials"
                        press="onMaterialsPress">
                        <TileContent
                            footer="{dashboardModel>/activeMaterialPercentage}% active">
                            <NumericContent
                                value="{dashboardModel>/materialCount}"
                                icon="sap-icon://product"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                    <!-- Purchase Orders Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Purchase Orders"
                        press="onPurchaseOrdersPress">
                        <TileContent
                            footer="{dashboardModel>/pendingApprovalCount} pending approval">
                            <NumericContent
                                value="{dashboardModel>/purchaseOrderCount}"
                                icon="sap-icon://cart"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                    <!-- Goods Receipt Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Goods Receipt"
                        press="onGoodsReceiptPress">
                        <TileContent
                            footer="{dashboardModel>/overdueReceiptCount} overdue">
                            <NumericContent
                                value="{dashboardModel>/goodsReceiptCount}"
                                icon="sap-icon://inbox"
                                state="{= ${dashboardModel>/overdueReceiptCount} > 0 ? 'Error' : 'Good'}"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                    <!-- Invoice Report Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Invoice Report"
                        press="onInvoicesPress">
                        <TileContent
                            footer="{dashboardModel>/invoicesNeedingVerification} need verification">
                            <NumericContent
                                value="{dashboardModel>/invoiceCount}"
                                icon="sap-icon://document-text"
                                state="{= ${dashboardModel>/invoicesNeedingVerification} > 0 ? 'Warning' : 'Good'}"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                    <!-- Invoice Printing Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Invoice Printing"
                        press="onInvoicesPress">
                        <TileContent
                            footer="â‚¬{dashboardModel>/invoicePrintingAmount}">
                            <NumericContent
                                value="{dashboardModel>/invoicePrintingTotal}"
                                icon="sap-icon://print"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                    <!-- Audit Report Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Audit Report"
                        press="onAuditPress">
                        <TileContent
                            footer="Last run: Today">
                            <NumericContent
                                value="{dashboardModel>/auditReportCount}"
                                icon="sap-icon://inspection"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                    <!-- Error Logs Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Error Logs">
                        <TileContent
                            footer="{dashboardModel>/errorsRequiringAttention} require attention">
                            <NumericContent
                                value="{dashboardModel>/errorLogCount}"
                                icon="sap-icon://error"
                                state="{= ${dashboardModel>/errorsRequiringAttention} > 0 ? 'Error' : 'Good'}"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                    <!-- Security Settings Tile -->
                    <GenericTile
                        class="sapUiTinyMarginBegin sapUiTinyMarginTop tileLayout"
                        header="Security Settings">
                        <TileContent
                            footer="{dashboardModel>/securityStatus}">
                            <NumericContent
                                icon="sap-icon://locked"
                                state="Loaded"
                                withMargin="false" />
                        </TileContent>
                    </GenericTile>

                </layout:Grid>

                <!-- Pending Approvals Section -->
                <Panel
                    headerText="Pending Approvals"
                    expandable="true"
                    expanded="true"
                    class="sapUiResponsiveMargin">

                    <content>
                        <Table id="pendingApprovalsTable" items="{/PurchaseOrders}">
                            <columns>
                                <Column><Text text="PO Number" /></Column>
                                <Column><Text text="Vendor" /></Column>
                                <Column><Text text="Amount" /></Column>
                                <Column><Text text="Status" /></Column>
                            </columns>

                            <items>
                                <ColumnListItem>
                                    <cells>
                                        <Text text="{poNumber}" />
                                        <Text text="{vendor/vendorName}" />
                                        <Text text="{totalAmount} {currency}" />
                                        <ObjectStatus 
                                            text="{approvalStatus}" 
                                            state="{= ${approvalStatus} === 'Pending Approval' ? 'Warning' : 'Success'}" />
                                    </cells>
                                </ColumnListItem>
                            </items>

                        </Table>
                    </content>
                </Panel>

            </ScrollContainer>
        </content>

    </Page>
</mvc:View>
